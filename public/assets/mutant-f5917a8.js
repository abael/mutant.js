!function(e,t){"use strict";function i(e,t,i){var n,a;return function(){var o=Date.now();n&&n+t>o?(clearTimeout(a),a=setTimeout(function(){n=o,e.apply(i)},t)):(n=o,e.apply(i))}}function n(e){this.callback=e,this.onModifications=i(function(){this.callback([])},5,this)}function a(e,t,i){this.element=e,this.callback=t,this.context=i,e.addEventListener("load",this,!1),e.addEventListener("error",this,!1)}function o(e){var t=!(1!==e.nodeType||"IMG"!==e.tagName||e.complete||e.getAttribute("width")&&e.getAttribute("height"));return t}function r(e,t,n){this._eventHandlers={};var a=n?n.scope:null,o=n?n.timeout:0,r=this;this._callback=o?i(function(){try{t.apply(a)}finally{r.takeRecords()}},o):function(){try{t.apply(a)}finally{r.takeRecords()}},this._findLoadingImages(e),this._mutationCallback=this._mutationCallback.bind(this),this.observer=new d(this._mutationCallback),this.observer.observe(e,{attributes:!0,childList:!0,characterData:!0,subtree:!0})}void 0===t&&(t={}),n.prototype={observe:function(e){this._target=e,e.addEventListener("DOMSubtreeModified",this.onModifications,!1)},disconnect:function(){this._target&&(this._target.removeEventListener("DOMSubtreeModified",this.onModifications,!1),delete this._target)},takeRecords:function(){var e=this._target;e.removeEventListener("DOMSubtreeModified",this.onModifications,!1),e.addEventListener("DOMSubtreeModified",this.onModifications,!1)}},a.prototype={_detach:function(){this.element&&(this.element.removeEventListener("load",this,!1),this.element.removeEventListener("error",this,!1),this.element=null,this.callback=null,this.context=null)},handleEvent:function(e){this.callback.call(this.context,e,this)}};var s=e.document,d=e.MutationObserver||e.MozMutationObserver||e.WebKitMutationObserver||n,c=0;return r.prototype={_addListener:function(e){if(!e.dataset.gLoadListenerId){var t=++c;e.dataset.gLoadListenerId=t,this._eventHandlers[t]=new a(e,function(e,t){t._detach(),this._callback()},this)}},_removeListener:function(e){var t=e.dataset.gLoadListenerId;if(t){delete e.dataset.gLoadListenerId;var i=this._eventHandlers[t];i&&(delete this._eventHandlers[t],i._detach())}},_mutationCallback:function(e){var t=this;e.forEach(function(e){var i;if("childList"===e.type){if(e.addedNodes)for(var n=0;n<e.addedNodes.length;n++)i=e.addedNodes[n],1===i.nodeType&&(i.children.length?t._findLoadingImages(i):o(i)&&t._addListener(i));if(e.removedNodes)for(var a=0;a<e.removedNodes.length;a++)i=e.removedNodes[a],1===i.nodeType&&(i.children.length||"IMG"===i.tagName&&t._removeListener(i))}}),this._callback()},_findLoadingImages:function(e){for(var t=s.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:function(e){return o(e)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}},!1);t.nextNode();)this._addListener(t.currentNode)},takeRecords:function(){return this.observer.takeRecords()},disconnect:function(){this.observer.disconnect();var e=this._eventHandlers;Object.keys(e).forEach(function(t){var i=e[t];i&&(delete e[t],i._detach())})}},e.Mutant=t.exports,r}(this,module);
//@ sourceMappingURL=mutant-fabe2c4.js.map